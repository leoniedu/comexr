---
output:
  github_document:
    keep_html: true
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

# comexstatr

<!-- badges: start -->

[![Lifecycle:
experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)
[![CRAN
status](https://www.r-pkg.org/badges/version/comexstatr)](https://CRAN.R-project.org/package=comexstatr)
<!-- badges: end -->

The goal of comexstatr is to make it easy to download, process, and
analyze Brazilian foreign trade statistics, available through the web
app <http://comexstat.mdic.gov.br/>, using the underlying bulk data
<https://www.gov.br/produtividade-e-comercio-exterior/pt-br/assuntos/comercio-exterior/estatisticas/base-de-dados-bruta>.

## Installation

You can install the development version of comexstatr cloning the repo
from github and installing locally.


## Example

``` {r}
##installing arrow
# options(
#   HTTPUserAgent =
#     sprintf(
#       "R/%s R (%s)",
#       getRversion(),
#       paste(getRversion(), R.version["platform"], R.version["arch"], R.version["os"])
#     )
# )
# install.packages("arrow", repos = "https://packagemanager.rstudio.com/all/__linux__/focal/latest")



##devtools::install_github("leoniedu/comexstatr")
##install.packages("tictoc")
library(comexstatr)

##downloading
tictoc::tic()
comexstat_download(
  ##force_download = TRUE
  )
tictoc::toc()


## summarise by ncm and year
tictoc::tic()
cstat <- comexstat()
cstat_ncm_year <- cstat|>
  dplyr::filter(co_ano>=2017)|>
  dplyr::group_by(co_ano, co_ncm, fluxo)|>
  dplyr::summarise(vl_fob=sum(vl_fob))|>
  dplyr::collect()|>
  dplyr::arrange(co_ano, co_ncm, fluxo)
head(cstat_ncm_year)
tictoc::toc()

tictoc::tic()
cstat_year <- cstat|>
  dplyr::group_by(co_ano, fluxo)|>
  dplyr::summarise(vl_fob_bi=sum(vl_fob)/1e9)|>
  dplyr::collect()|>
  dplyr::arrange(co_ano, fluxo)
head(cstat_year)
tictoc::toc()

```
